{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}

<!-- Main Section -->
<section style="padding-top: 150px;" id="intro" class="intro-section">
    {% include 'main/top_section.html' %}
</section>

<!-- About Section -->
<!-- <section id="about" class="about-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h1>About Section</h1>
            </div>
        </div>
    </div>
</section> -->

<!-- Project Section -->
<section id="project" class="project-section">
    {% include 'main/project.html' %}
  
</section>

<!-- Contact Section -->
<section id="contact" class="contact-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <h1>Contact Section</h1>
                <div class="mail_container contact_me_container">
                    <div class="content">
                        <div class="circle">
                            <div class="mail-box">
                                <div class="flag"></div>
                            </div>
                        </div>
                    </div>
                    <div class="content"></div>
                    <div class="content draggable_envelope">
                        <div class="envelope"></div>
                        <div class="letter">
                            <div class="body">
                                <span class="close" onclick="event.stopPropagation(); closeCard()">x</span>
                                <form class="message" method="post">
                                    {% csrf_token %}
                                    {{contact_me_form|crispy}}
                                </form>
                            </div>
                        </div>
                        <div class="shadow"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<style>
    :root {
        --base: #5E5690;
        --base-light: #7873A7;
        --base-dark: #555184;
        --shadow: #4F4C6B;
        --letter: #d8d7e5;
    }
    html, body {
    padding: 0;
}
    * {
        border: 0;
        margin: 0;
        box-sizing: border-box;
    }

    h1 {
        font-size: 50px;
    }
    ul {
            list-style-type: none;
            margin-left:-4rem;
            font-size: 1.45rem;
            margin-bottom: 0;
        }

    .intro-section {
        height: 100%;
        z-index: 100;
        background: linear-gradient(180deg, rgb(255, 255, 255), rgba(255, 255, 255, 0.85), transparent);
    }

    .description {
        background-color: rgb(255, 255, 255, 0.55);
        backdrop-filter: blur(5px);
        margin-top: -10px;
       
    }

    @media screen and (min-width:992px) {
        .description {
            text-align: left;
        }

        ul {
            list-style-type: inherit;
        }
    }

    .mail_container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        margin-left: -200px;
        justify-content: space-evenly;
    }

    .content {
        position: relative;
        perspective: 600px;
    }

    .shadow {
        position: absolute;
        width: 100px;
        height: 1px;
        background: transparent;
        border-radius: 30%;
        box-shadow: 50px 100px 10px 5px #eeeef3;
    }

    .letter {
        position: absolute;
        top: 10px;
        left: 10px;
        width: 175px;
        height: 73px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 15;
        border-radius: 2px;
        background: var(--letter);
        box-shadow: 0px 1px 7px -2px var(--base);
    }

    .letter:hover::before {
        display: none;
    }

    .letter .body {
        position: relative;
        width: 95%;
        height: 90%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--base);
    }

    .letter .body .close {
        position: absolute;
        right: 10px;
        top: 0;
        font-size: 30px;
        font-family: "Manjari", sans-serif;
        cursor: pointer;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    .letter .body .message {
        font-size: 20px;
        font-weight: 900;
        display: none;
        transition: 0s;
        text-align: left;
        font-family: "Great Vibes", cursive;
    }

    .envelope {
        position: relative;
        width: 200px;
        height: 110px;
        background: linear-gradient(#cccbd7 0.5px, var(--base-light) 0.5px);
        cursor: pointer;
    }

    .envelope::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 200px;
        border-top: 74px solid #7873A7;
        border-left: 100px solid transparent;
        border-right: 100px solid transparent;
        box-sizing: border-box;
        z-index: 30;
        transform-origin: top;
    }

    .envelope::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0px;
        width: 200px;
        height: 110px;
        z-index: 25;
        background: linear-gradient(30deg, var(--base-dark) 47%, var(--shadow) 50%, var(--base) 50%) 100px 55px/100px 55px no-repeat, linear-gradient(31deg, var(--base) 49%, var(--shadow) 50%, transparent 50%) 0px 0px/100px 55px no-repeat, linear-gradient(150deg, var(--base) 50%, var(--shadow) 50%, var(--base-dark) 53%) 0px 55px/101px 55px no-repeat, linear-gradient(148.7deg, transparent 50%, var(--shadow) 50%, var(--base) 51%) 100px 0px/100px 55px no-repeat;
    }


    /* mainbox  */


    .mailbox_container {
        width: 350px;

        text-align: center;
    }

    .mail_container:before {
        content: '';
        display: inline-block;
        height: 100%;
        vertical-align: middle;
        /* Adjusts for spacing */
    }


    .mail-box {
        display: inline-block;
        vertical-align: middle;
        *vertical-align: auto;
        *zoom: 1;
        *display: inline;
        -moz-border-radius: 25px 25px 0 0;
        -webkit-border-radius: 25px;
        border-radius: 25px 25px 0 0;
        width: 200px;
        height: 105px;
        background-color: #3498db;
        margin: 0 auto;
        position: relative;
    }

    .mail-box:before,
    .mail-box:after {
        content: '';
        display: block;
        position: absolute;
    }

    .mail-box:before {
        -moz-border-radius: 25px 25px 0 0;
        -webkit-border-radius: 25px;
        border-radius: 25px 25px 0 0;
        background-color: #9FC9F0;
        width: 60px;
        left: 0;
        height: 100%;
    }

    .mail-box:after {
        width: 8px;
        height: 200%;
        left: 50%;
        bottom: -200%;
        margin-left: -4px;
        background-color: #12467E;
    }

    .flag {
        -moz-transform-origin: 50% 100%;
        -ms-transform-origin: 50% 100%;
        -webkit-transform-origin: 50% 100%;
        transform-origin: 60% 100%;
        width: 8px;
        height: 100%;
        margin: -25% auto 0 auto;
        background-color: #e74c3c;
        position: relative;
    }

    .flag:before,
    .flag:after {
        content: '';
        display: block;
        position: absolute;
    }

    .flag:before {
        background-color: inherit;
        width: 32px;
        left: 0;
        top: 0;
        height: 16px;
    }

    .flag:after {
        -moz-border-radius: 24px;
        -webkit-border-radius: 24px;
        border-radius: 24px;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        background-color: #9FC9F0;
        border: 8px solid #e74c3c;
        width: 24px;
        height: 24px;
        left: 60%;
        margin-left: -12px;
        bottom: -12px;
    }

    @-webkit-keyframes mailBoxUp {
        from {
            filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
            opacity: 0;
            -moz-transform: translate3d(0, 90px, 0);
            -ms-transform: translate3d(0, 90px, 0);
            -webkit-transform: translate3d(0, 90px, 0);
            transform: translate3d(0, 90px, 0);
        }

        to {
            filter: progid:DXImageTransform.Microsoft.Alpha(enabled=false);
            opacity: 1;
            -moz-transform: translate3d(0, 0, 0);
            -ms-transform: translate3d(0, 0, 0);
            -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
        }
    }

    @keyframes mailBoxUp {
        from {
            filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
            opacity: 0;
            -moz-transform: translate3d(0, 90px, 0);
            -ms-transform: translate3d(0, 90px, 0);
            -webkit-transform: translate3d(0, 90px, 0);
            transform: translate3d(0, 90px, 0);
        }

        to {
            filter: progid:DXImageTransform.Microsoft.Alpha(enabled=false);
            opacity: 1;
            -moz-transform: translate3d(0, 0, 0);
            -ms-transform: translate3d(0, 0, 0);
            -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0);
        }
    }

    @-webkit-keyframes flagSpin {
        from {
            filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
            opacity: 0;
            -moz-transform: rotate(-90deg);
            -ms-transform: rotate(-90deg);
            -webkit-transform: rotate(-90deg);
            transform: rotate(-90deg);
        }

        to {
            filter: progid:DXImageTransform.Microsoft.Alpha(enabled=false);
            opacity: 1;
            -moz-transform: rotate(0);
            -ms-transform: rotate(0);
            -webkit-transform: rotate(0);
            transform: rotate(0);
        }
    }

    @keyframes flagSpin {
        from {
            filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
            opacity: 0;
            -moz-transform: rotate(-90deg);
            -ms-transform: rotate(-90deg);
            -webkit-transform: rotate(-90deg);
            transform: rotate(-90deg);
        }

        to {
            filter: progid:DXImageTransform.Microsoft.Alpha(enabled=false);
            opacity: 1;
            -moz-transform: rotate(0);
            -ms-transform: rotate(0);
            -webkit-transform: rotate(0);
            transform: rotate(0);
        }
    }

    .mail-box {
        animation: mailBoxUp 0.5s cubic-bezier(0.77, 0, 0.175, 1);
        -webkit-animation: mailBoxUp 0.5s cubic-bezier(0.77, 0, 0.175, 1);
    }

    .flag {
        -moz-backface-visibility: hidden;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        animation: flagSpin 500ms 250ms backwards cubic-bezier(0.68, -0.55, 0.265, 1.55);
        -webkit-animation: flagSpin 500ms 250ms backwards cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.2.6/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.4.0/CSSRulePlugin.min.js"></script>

<script>
    let t1 = gsap.timeline({ paused: true });
    let flap = CSSRulePlugin.getRule(".envelope:before");

    t1.to(flap, {
        duration: 0.35,
        cssRule: {
            rotateX: 180
        }
    })
        .set(flap, {
            cssRule: {
                zIndex: 10
            }
        })
        .to('.letter', {
            translateY: -200,
            duration: 0.55,
            ease: "back.inOut(1.5)"
        })
        .set('.letter', {
            zIndex: 40
        })
        .to('.letter', {
            duration: .55,
            ease: "back.out(.4)",
            translateY: -200,
            translateX: -250,
            translateZ: -100,
            height: 400,
            width: 300,
        })
        .to('.message', {
            display: 'block',
            duration: 0
        })
        ;

    let t2 = gsap.timeline({ paused: true });
    t2.to('.shadow', {
        delay: 1,
        width: 350,
        boxShadow: "-75px 150px 10px 5px #eeeef3",
        ease: "back.out(.2)",
        duration: .55
    });

    function openCard(e) {
        t1.play();
        t2.play();
    }

    function closeCard(e) {
        t1.reverse();
        t2.reverse();
    }

    $(function () {
        $(".draggable_envelope").draggable({
            containment: ".contact_me_container",
            stop: function (event, ui) {
                // event.toElement is the element that was responsible
                // for triggering this event. The handle, in case of a draggable.
                $(event.originalEvent.target).one('click', function (e) { e.stopImmediatePropagation(); });
            }
        })
    });
    $(".draggable_envelope").click(e => openCard(e));





</script>

{% endblock %}